watch:
  client:
    before:
      - 'compile'
    watchers:
      - patterns: 'lib'
        tasks: 'compile'

tasks:

    build-server:
      - '@shell rm -rf dist'
      - '@npm tsc'

    build-client:
      - browserify
      - uglify

    build-all:
      - build-server
      - build-client

    nodemon: >
      @bgShell nodemon
      example.server.js
      --watch dist
      --watch client/dist
      --delay 2

    watchify: >
      @npm watchify
      client/lib/index.js -o client/dist/index.js
      -v -t [ babelify --presets [ es2015 ] ]

    browserify: >
      @npm browserify
      client/lib/index.js -o client/dist/index.js
      -t [ babelify --presets [ es2015 ] ]

    uglify: >
      @npm uglifyjs
      client/dist/index.js >
      client/dist/index.min.js

    socketio: >
      @npm uglifyjs
      public/socket.io.js >
      client/dist/socket.io.min.js
